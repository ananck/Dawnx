$$
\begin{align}
A &= q^a \ mod \ p \\
K &= B^a \ mod \ p
\end{align}
$$

$$
\begin{align}
B &= q^b \ mod \ p \\
K &= A^b \ mod \ p
\end{align}
$$

Key：
$$
\begin{align}
K &= A^b \ mod \ p \\
&= (q^a \ mod \ p)^b \ mod \ p \\
&= q^{ab} \ mod \ p \\
\end{align}
$$

$$
\begin{align}
K &= B^a \ mod \ p \\
&= (q^b \ mod \ p)^a \ mod \ p \\
&= q^{ab} \ mod \ p \\
\end{align}
$$

$$
\begin{align}
K = B^a \ mod \ p = A^b \ mod \ p
\end{align}
$$

The count of **Keys**:



Crack：

